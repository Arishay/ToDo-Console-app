# Data Model: Todo CLI Core

**Feature**: 001-todo-cli-core
**Date**: 2025-12-29
**Status**: Complete

## Overview

This document defines the data entities and their relationships for the Todo CLI Core feature. The model is intentionally simple, consisting of a single entity (Task) with no complex relationships, as required by the Phase I specification.

## Entities

### Task

Represents a single todo item in the system.

**Attributes**:

| Attribute | Type | Required | Constraints | Description |
|-----------|------|----------|-------------|-------------|
| id | int | Yes | Auto-generated, unique, ≥ 1 | Unique identifier for the task, auto-incremented starting from 1 |
| title | str | Yes | Non-empty, max 500 characters | Short description of the task |
| description | str | No | Max 2000 characters | Detailed information about the task (default: empty string) |
| is_complete | bool | Yes | true or false | Completion status of the task (default: false) |

**Validation Rules**:

1. **Title Validation**:
   - MUST NOT be empty or whitespace-only
   - MUST NOT exceed 500 characters
   - Leading/trailing whitespace SHOULD be stripped before storage

2. **Description Validation**:
   - MAY be empty (default)
   - MUST NOT exceed 2000 characters
   - Leading/trailing whitespace SHOULD be stripped before storage

3. **ID Validation**:
   - MUST be auto-generated by the system
   - MUST be unique within the session
   - MUST start from 1 and increment sequentially
   - Users MUST NOT be able to set or modify IDs directly

4. **Status Validation**:
   - MUST be boolean (true for complete, false for incomplete)
   - Default value: false (incomplete)

**State Transitions**:

```
[New Task]
    ↓ (add operation)
[Incomplete Task] (is_complete = false)
    ↓ (toggle operation)
[Complete Task] (is_complete = true)
    ↓ (toggle operation)
[Incomplete Task] (is_complete = false)
    ... (cycle continues)
```

**Lifecycle**:
1. **Creation**: Task created with auto-generated ID, user-provided title/description, is_complete = false
2. **Update**: Title and/or description can be modified; ID and is_complete unchanged
3. **Toggle**: is_complete flips between true/false; other attributes unchanged
4. **Deletion**: Task removed from storage entirely

**Invariants**:
- A task's ID MUST NEVER change after creation
- A task MUST ALWAYS have a non-empty title
- A task MUST ALWAYS have a boolean is_complete status

## Relationships

None - Phase I implements a flat list of independent tasks with no relationships between entities.

## Storage Representation

### In-Memory Storage

Tasks are stored in a Python dictionary keyed by task ID:

```python
# Storage structure
tasks: dict[int, Task] = {
    1: Task(id=1, title="...", description="...", is_complete=False),
    2: Task(id=2, title="...", description="...", is_complete=True),
    # ...
}

# Next ID tracker
next_id: int = 3  # Next ID to assign
```

**Rationale**:
- O(1) lookup by ID for get/update/delete/toggle operations
- Dictionary preserves insertion order (Python 3.7+)
- Simple tracking of next ID with integer counter

## Data Examples

### Valid Task Examples

**Example 1: Minimal task (title only)**
```python
Task(
    id=1,
    title="Buy groceries",
    description="",
    is_complete=False
)
```

**Example 2: Complete task with description**
```python
Task(
    id=2,
    title="Review pull request #47",
    description="Check for security issues and test coverage. Verify compliance with coding standards.",
    is_complete=True
)
```

**Example 3: Incomplete task with long description**
```python
Task(
    id=3,
    title="Implement user authentication",
    description="Research OAuth2 providers (Google, GitHub). Design login flow. Implement backend endpoints. Add frontend forms. Write integration tests. Update documentation.",
    is_complete=False
)
```

### Invalid Task Examples

**Invalid 1: Empty title**
```python
Task(
    id=1,
    title="",  # ❌ Violates non-empty constraint
    description="Some description",
    is_complete=False
)
```

**Invalid 2: Title too long**
```python
Task(
    id=2,
    title="a" * 501,  # ❌ Exceeds 500 character limit
    description="",
    is_complete=False
)
```

**Invalid 3: Description too long**
```python
Task(
    id=3,
    title="Valid title",
    description="b" * 2001,  # ❌ Exceeds 2000 character limit
    is_complete=False
)
```

## Implementation Guidance

### Python Dataclass Definition

```python
from dataclasses import dataclass

@dataclass
class Task:
    """Represents a todo task.

    Attributes:
        id: Unique auto-generated identifier (≥ 1)
        title: Short task description (required, max 500 chars)
        description: Detailed task information (optional, max 2000 chars)
        is_complete: Completion status (default: False)
    """
    id: int
    title: str
    description: str
    is_complete: bool

    def __post_init__(self) -> None:
        """Validate task attributes after initialization."""
        if not self.title or not self.title.strip():
            raise ValueError("Task title cannot be empty")
        if len(self.title) > 500:
            raise ValueError("Task title cannot exceed 500 characters")
        if len(self.description) > 2000:
            raise ValueError("Task description cannot exceed 2000 characters")

        # Normalize whitespace
        self.title = self.title.strip()
        self.description = self.description.strip()
```

### Validation Functions

```python
def validate_title(title: str) -> tuple[bool, str]:
    """Validate task title.

    Returns:
        (is_valid, error_message) tuple
    """
    if not title or not title.strip():
        return (False, "Task title cannot be empty")
    if len(title) > 500:
        return (False, "Task title cannot exceed 500 characters")
    return (True, "")

def validate_description(description: str) -> tuple[bool, str]:
    """Validate task description.

    Returns:
        (is_valid, error_message) tuple
    """
    if len(description) > 2000:
        return (False, "Task description cannot exceed 2000 characters")
    return (True, "")
```

## Mapping to Functional Requirements

| Data Model Element | Functional Requirement | Notes |
|-------------------|------------------------|-------|
| Task.id | FR-002 | Auto-incrementing integer starting from 1 |
| Task.title | FR-001 | Required, max 500 characters |
| Task.description | FR-001 | Optional, max 2000 characters |
| Task.is_complete | FR-003, FR-005 | Boolean status, toggled by user |
| Validation rules | FR-009 | Clear error messages for constraint violations |
| Dictionary storage | FR-003, FR-008 | In-memory storage with O(1) ID validation |

## Future Considerations (Out of Scope for Phase I)

The following enhancements are explicitly out of scope but noted for potential future phases:

- **Persistence**: Task.created_at, Task.updated_at timestamps
- **Categorization**: Task.tags, Task.priority fields
- **Scheduling**: Task.due_date, Task.reminder fields
- **Relationships**: Parent/child tasks, dependencies
- **Metadata**: Task.created_by, Task.assigned_to (multi-user)

These are intentionally excluded per the specification's "Out of Scope" section.
